<div data-ng-controller="resourcePoolCustomViewController as vm">
    <h2>{{ vm.resourcePool.Name }}</h2>
    <!--
    <table class="resourcePoolTable">
        <thead>
            <tr>
                <th>
                    <table class="resourcePoolFieldsTable">
                        <thead>
                            <tr>
                                <th>
                                    Field 1
                                </th>
                                <th>
                                    Field 2
                                    <table class="fieldIndexTable">
                                        <colgroup>
                                            <col class="valueMultipliedField" />
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <thead>
                                            <tr>
                                                <th colspan="3">
                                                    Index Name
                                                </th>
                                            </tr>
                                            <tr>
                                                <th>
                                                    Value Mult.
                                                </th>
                                                <th>
                                                    %
                                                </th>
                                                <th>
                                                    Income
                                                </th>
                                            </tr>
                                        </thead>
                                    </table>
                                </th>
                                <th>
                                    Field 3
                                </th>
                            </tr>
                        </thead>
                    </table>
                </th>
                <th>
                    Total Income
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <table class="resourcePoolFieldsTable">
                        <tbody>
                            <tr>
                                <td>
                                    Item 1 - Field 1
                                </td>
                                <td>
                                    Item 1 - Field 2
                                    <table class="fieldIndexTable">
                                        <colgroup>
                                            <col class="valueMultipliedField" />
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    Item 1 - Value Mult.
                                                </td>
                                                <td>
                                                    Item 1 - %
                                                </td>
                                                <td>
                                                    Item 1 - Income
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td>
                                    Item 1 - Field 3
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td>
                    Item 1 - Total income
                </td>
            </tr>
            <tr>
                <td>
                    <table class="resourcePoolFieldsTable">
                        <tbody>
                            <tr>
                                <td>
                                    Item 2 - Field 1
                                </td>
                                <td>
                                    Item 2 - Field 2
                                    <table class="fieldIndexTable">
                                        <colgroup>
                                            <col class="valueMultipliedField" />
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    Item 2 - Value Mult.
                                                </td>
                                                <td>
                                                    Item 2 - %
                                                </td>
                                                <td>
                                                    Item 2 - Income
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td>
                                    Item 2 - Field 3
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td>
                    Item 2 - Total income
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>
                    <table class="resourcePoolFieldsTable">
                        <tbody>
                            <tr>
                                <td>
                                    Field 1 total
                                </td>
                                <td>
                                    Field 2 total
                                    <table class="fieldIndexTable">
                                        <colgroup>
                                            <col class="valueMultipliedField" />
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    Value Mult. total
                                                </td>
                                                <td>
                                                    % total
                                                </td>
                                                <td>
                                                    Income total
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td>
                                    Field 3 total
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td>
                    Grand total income
                </td>
            </tr>
        </tfoot>
    </table>-->

    <table class="resourcePoolTable table-striped">
        <thead>
            <tr>
                <!-- Fields -->
                <th data-ng-repeat="field in vm.resourcePool.MainElement.ElementFieldSet">
                    <table class="resourcePoolFieldsTable">
                        <thead>
                            <tr>
                                <th>
                                    {{ field.Name }}
                                    <!-- Indexes -->
                                    <table class="fieldIndexTable" data-ng-repeat="index in field.ElementFieldIndexSet">
                                        <colgroup>
                                            <!--<col class="valueMultipliedField" />-->
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <thead>
                                            <tr>
                                                <th colspan="3" data-ng-if="field.ElementFieldIndexSet.length > 0">
                                                    {{ field.ElementFieldIndexSet[0].Name }}
                                                </th>
                                            </tr>
                                            <tr>
                                                <!--<th>
                                                    Value Mult.
                                                </th>-->
                                                <th>
                                                    %
                                                </th>
                                                <th>
                                                    Income
                                                </th>
                                            </tr>
                                        </thead>
                                    </table>
                                    <!-- Multiplier functions -->
                                    <div data-ng-if="field.ElementFieldType === 12">
                                        <div class="clearfix"></div>
                                        <div class="btn-group" role="group">
                                            <button type="submit" data-ng-click="vm.increaseMultiplier()" class="btn btn-default btn-xs">+</button>
                                            <button type="submit" data-ng-click="vm.decreaseMultiplier()" class="btn btn-default btn-xs">-</button>
                                            <button type="submit" data-ng-click="vm.resetMultiplier()" class="btn btn-default btn-xs">0</button>
                                        </div>
                                    </div>
                                </th>
                                <!-- ResourcePool -->
                                <!-- TODO Single container for these fields? -->
                                <th data-ng-if="field.ElementFieldType === 11">
                                    CMRP Add.<br />
                                    Rate {{ vm.resourcePool.ResourcePoolRatePercentage | percentage:2 }}<br />
                                    # {{ vm.resourcePool.UserResourcePoolRatingCount }}
                                    <!-- ResourcePool functions -->
                                    <div data-ng-if="field.ElementFieldType === 11">
                                        <div class="clearfix"></div>
                                        <div class="btn-group" role="group">
                                            <button type="submit" data-ng-click="vm.increaseResourcePoolRate()" class="btn btn-default btn-xs">+</button>
                                            <button type="submit" data-ng-click="vm.decreaseResourcePoolRate()" class="btn btn-default btn-xs">-</button>
                                            <button type="submit" data-ng-click="vm.resetResourcePoolRate()" class="btn btn-default btn-xs">0</button>
                                        </div>
                                    </div>
                                </th>
                                <th data-ng-if="field.ElementFieldType === 11">
                                    {{ field.Name }}<br />
                                    incl. CMRP Add.
                                </th>
                                <!-- Multiplier -->
                                <!-- TODO Single container for these fields? -->
                                <!--<th data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    Tot. {{ vm.resourcePool.MainElement.ResourcePoolFieldName }}
                                </th>
                                <th data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    Tot. CMRP Add.
                                </th>-->
                                <th data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    Tot. {{ vm.resourcePool.MainElement.ResourcePoolFieldName }}
                                    <br />incl. CMRP Add.
                                </th>
                            </tr>
                        </thead>
                    </table>
                </th>
                <!-- Totals -->
                <th>
                    Tot. Income
                </th>
            </tr>
        </thead>
        <tbody>
            <tr data-ng-repeat="elementItem in vm.resourcePool.MainElement.ElementItemSet">
                <!-- Cells -->
                <td data-ng-repeat="elementCell in elementItem.ElementCellSet">
                    <table class="resourcePoolFieldsTable">
                        <tbody>
                            <tr>
                                <td>
                                    <span data-ng-if="elementCell.ElementFieldType === 1">
                                        {{ elementCell.StringValue }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 2">
                                        {{ elementCell.BooleanValue }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 3">
                                        {{ elementCell.IntegerValue }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 4">
                                        {{ elementCell.DecimalValue | number: 2 }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 5">
                                        {{ elementCell.DateTimeValue }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 6">
                                        <!-- Element value ? -->
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 11">
                                        {{ elementItem.ResourcePoolValue | number: 2 }}
                                    </span>
                                    <span data-ng-if="elementCell.ElementFieldType === 12">
                                        {{ elementItem.MultiplierValue | number: 2 }}
                                    </span>
                                    <!-- Indexes -->
                                    <table class="fieldIndexTable" data-ng-repeat="index in elementCell.ElementField.ElementFieldIndexSet">
                                        <colgroup>
                                            <!--<col class="valueMultipliedField" />-->
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <tbody>
                                            <tr>
                                                <!--<td>
                                                    {{ elementCell.ValueMultiplied | number:2 }}
                                                </td>-->
                                                <td>
                                                    {{ elementCell.ValuePercentage | percentage:2 }}
                                                </td>
                                                <td>
                                                    {{ elementCell.ElementFieldIndexIncome | number:2 }}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <!-- ResourcePool -->
                                <!-- TODO Single container for these fields? -->
                                <td data-ng-if="elementCell.ElementFieldType === 11">
                                    {{ elementItem.ResourcePoolAddition | number: 2 }}
                                </td>
                                <td data-ng-if="elementCell.ElementFieldType === 11">
                                    {{ elementItem.ResourcePoolValueIncludingAddition | number: 2 }}
                                </td>
                                <!-- Multiplier -->
                                <!-- TODO Single container for these fields? -->
                                <!--<td data-ng-if="elementCell.ElementFieldType === 12 && elementItem.HasResourcePoolCell">
                                    {{ elementItem.TotalResourcePoolValue | number: 2 }}
                                </td>
                                <td data-ng-if="elementCell.ElementFieldType === 12 && elementItem.HasResourcePoolCell">
                                    {{ elementItem.TotalResourcePoolAddition | number: 2 }}
                                </td>-->
                                <td data-ng-if="elementCell.ElementFieldType === 12 && elementItem.HasResourcePoolCell">
                                    {{ elementItem.TotalResourcePoolValueIncludingAddition | number: 2 }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <!-- Totals -->
                <td>
                    {{ elementItem.TotalIncome | number:2 }}
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <!-- Fields -->
                <td data-ng-repeat="field in vm.resourcePool.MainElement.ElementFieldSet">
                    <table class="resourcePoolFieldsTable">
                        <tfoot>
                            <tr>
                                <td>
                                    <!-- TODO Grand Total? -->
                                    <span data-ng-if="field.ElementFieldType === 11">
                                        {{ vm.resourcePool.MainElement.ResourcePoolValue | number: 2 }}
                                    </span>
                                    <span data-ng-if="field.ElementFieldType === 12">
                                        {{ vm.resourcePool.MainElement.MultiplierValue | number: 2 }}
                                    </span>
                                    <!-- Indexes -->
                                    <table class="fieldIndexTable" data-ng-repeat="index in field.ElementFieldIndexSet">
                                        <colgroup>
                                            <!--<col class="valueMultipliedField" />-->
                                            <col class="valuePercentageField" />
                                            <col class="indexIncomeField" />
                                        </colgroup>
                                        <tfoot>
                                            <tr>
                                                <!--<td>
                                                    {{ index.ValueMultiplied | number:2 }}
                                                </td>-->
                                                <td>
                                                    {{ index.ValuePercentage | percentage:2 }}
                                                </td>
                                                <td>
                                                    {{ index.ElementFieldIndexIncome | number:2 }}
                                                </td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </td>
                                <!-- ResourcePool -->
                                <!-- TODO Single container for these fields? -->
                                <td data-ng-if="field.ElementFieldType === 11">
                                    {{ vm.resourcePool.MainElement.ResourcePoolAddition | number: 2 }}
                                </td>
                                <td data-ng-if="field.ElementFieldType === 11">
                                    {{ vm.resourcePool.MainElement.ResourcePoolValueIncludingAddition | number: 2 }}
                                </td>
                                <!-- Multiplier -->
                                <!-- TODO Single container for these fields? -->
                                <!--<td data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    {{ vm.resourcePool.MainElement.TotalResourcePoolValue | number: 2 }}
                                </td>
                                <td data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    {{ vm.resourcePool.MainElement.TotalResourcePoolAddition | number: 2 }}
                                </td>-->
                                <td data-ng-if="field.ElementFieldType === 12 && vm.resourcePool.MainElement.HasResourcePoolField">
                                    {{ vm.resourcePool.MainElement.TotalResourcePoolValueIncludingAddition | number: 2 }}
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </td>
                <!-- Totals -->
                <td>
                    {{ vm.resourcePool.MainElement.TotalIncome | number: 2 }}
                </td>
            </tr>
        </tfoot>
    </table>
</div>
